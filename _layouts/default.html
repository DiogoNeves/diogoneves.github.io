<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.title | default: site.name | default: "Diogo Neves" }}</title>
    <meta name="description" content="{{ site.description | default: "Diogo is building on YouTube." }}" />
    <link rel="stylesheet" href="{{ '/style.css' | relative_url }}" />
  </head>
  <body>
    <main class="page" id="page-root">
      {{ content }}
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // Update the rotating status lines here.
        const MESSAGES = [
          'Analysing YouTube experiments...',
          'Building tools I actually use...',
          'Logging every video. Iterating forever...',
          'Decrypting growth patterns...',
          'Simulating the next 100 uploads...'
        ];

        const glitchTarget = document.getElementById('glitch-text');
        if (!glitchTarget || !MESSAGES.length) return;

        const GLITCH_CHARACTERS = '!#$%&()*+,-./:;<=>?@[\\]^_{|}~█▓▒░01';
        const GLITCH_DURATION = 650;
        const GLITCH_STEP = 55;
        const DISPLAY_INTERVAL = 3400;
        let messageIndex = 0;

        const getRandomChar = () => GLITCH_CHARACTERS[Math.floor(Math.random() * GLITCH_CHARACTERS.length)];

        const scramble = (text, revealProgress) => {
          const minLength = Math.max(text.length, 18);
          return Array.from({ length: minLength }, (_, idx) => {
            if (idx >= text.length) return getRandomChar();
            const revealPoint = Math.max(0, Math.min(1, revealProgress - (idx / text.length) * 0.35));
            const shouldReveal = Math.random() < revealPoint;
            return shouldReveal ? text[idx] : getRandomChar();
          }).join('');
        };

        const glitchToMessage = (nextMessage) => {
          let elapsed = 0;
          const intervalId = setInterval(() => {
            elapsed += GLITCH_STEP;
            const progress = Math.min(1, elapsed / GLITCH_DURATION);

            if (progress >= 1) {
              clearInterval(intervalId);
              glitchTarget.textContent = nextMessage;
              return;
            }

            glitchTarget.textContent = scramble(nextMessage, progress);
          }, GLITCH_STEP);
        };

        const showNextMessage = () => {
          glitchToMessage(MESSAGES[messageIndex]);
          messageIndex = (messageIndex + 1) % MESSAGES.length;
        };

        showNextMessage();
        setInterval(showNextMessage, GLITCH_DURATION + DISPLAY_INTERVAL);
      });
    </script>
  </body>
</html>
